<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by Apache Maven Doxia Site Renderer 1.4 at 2015-07-26 -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>smt-spring-security-stateless - </title>
    <style type="text/css" media="all">
      @import url("./css/maven-base.css");
      @import url("./css/maven-theme.css");
      @import url("./css/site.css");
    </style>
    <link rel="stylesheet" href="./css/print.css" type="text/css" media="print" />
    <meta name="Date-Revision-yyyymmdd" content="20150726" />
    <meta http-equiv="Content-Language" content="en" />
        
        </head>
  <body class="composite">
    <div id="banner">
                    <div id="bannerLeft">
                smt-spring-security-stateless
                </div>
                    <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
            
                    
                  <div class="xright">        
                    
                 <span id="projectVersion">Version: 1.3-SNAPSHOT</span>
      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
             
                    
                                <h5>Overview</h5>
                  <ul>
                  <li class="none">
            <strong>About</strong>
          </li>
                  <li class="none">
                          <a href="jacoco/index.html" title="Coverage">Coverage</a>
            </li>
                  <li class="none">
                          <a href="apidocs/index.html" title="JavaDoc">JavaDoc</a>
            </li>
                  <li class="none">
                          <a href="source-repository.html" title="Source">Source</a>
            </li>
          </ul>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="poweredBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                   
                    
            </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        <!-- -
Copyright 2015 Karl Bennett

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License. --><p>This library contains two customisable classes that help with configuring Spring Security to be stateless. This library does not provide any help with the initial sign in, it will just take over after the sign in has succeed and for all subsequent authentication checks after that.</p>
<div class="section">
<div class="section">
<h3>Maven<a name="Maven"></a></h3>

<div class="source">
<pre>&lt;dependencies&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;com.github.shiver-me-timbers&lt;/groupId&gt;
        &lt;artifactId&gt;smt-spring-security-stateless&lt;/artifactId&gt;
        &lt;version&gt;1.2&lt;/version&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;
</pre></div></div>
<div class="section">
<h3>Usage<a name="Usage"></a></h3>
<div class="section">
<h4><a class="externalLink" href="https://github.com/shiver-me-timbers/smt-spring-security-stateless/blob/master/src/main/java/shiver/me/timbers/security/spring/StatelessAuthenticationSuccessHandler.java">StatelessAuthenticationSuccessHandler</a><a name="StatelessAuthenticationSuccessHandler"></a></h4>
<p>This handler will be called after a successful authentication/sign, it adds an <tt>X-AUTH-TOKEN</tt> header and cookie to the response that contains a token (default is JWT). This token or cookie should then be supplied with every subsequent request.</p>
<p>This handler can be added to Spring Security with the <a class="externalLink" href="http://docs.spring.io/spring-security/site/docs/4.0.2.RELEASE/reference/htmlsingle/#jc-httpsecurity"><tt>HttpSecurity</tt></a> fluent API.</p>

<div class="source">
<pre>http.formLogin().successHandler(
    new StatelessAuthenticationSuccessHandler(&quot;some secret&quot;, &quot;/app/root&quot;)
);
</pre></div>
<p>This class can be further configured to through it&#x2019;s constructors, one common customisation would be to add a more secure <a class="externalLink" href="https://github.com/shiver-me-timbers/smt-spring-security-stateless/blob/master/src/main/java/shiver/me/timbers/security/token/TokenFactory.java"><tt>TokenFactory</tt></a> the default factory doesn&#x2019;t have any expiration date.</p>

<div class="source">
<pre>http.formLogin().successHandler(
    new StatelessAuthenticationSuccessHandler(new ExpringTokenFactory(), &quot;/app/root&quot;)
);
</pre></div></div>
<div class="section">
<h4><a class="externalLink" href="https://github.com/shiver-me-timbers/smt-spring-security-stateless/blob/master/src/main/java/shiver/me/timbers/security/spring/StatelessAuthenticationFilter.java">StatelessAuthenticationFilter</a><a name="StatelessAuthenticationFilter"></a></h4>
<p>This filter will check every request for the <tt>X-AUTH-TOKEN</tt> header or cookie and if it is valid authorise the request. It must be configured with the same secret or <tt>TokenFactory</tt> that was used in the <tt>StatelessAuthenticationSuccessHandler</tt>.</p>
<p>The filter can also be added to Spring Security with the <tt>HttpSecurity</tt>. It must be added before the Spring Security internal <a class="externalLink" href="http://docs.spring.io/spring-security/site/docs/4.0.2.RELEASE/reference/htmlsingle/#ns-custom-filters"><tt>UsernamePasswordAuthenticationFilter</tt></a> so that it will authorise the request before a sign in is required.</p>

<div class="source">
<pre>http.addFilterBefore(
    new StatelessAuthenticationFilter(&quot;some secret&quot;),
    UsernamePasswordAuthenticationFilter.class
);
</pre></div>
<p>Further customisation can also be done using it&#x2019;s constructors. Again, supplying a better <tt>TokenFactory</tt> would be a good example.</p>

<div class="source">
<pre>http.addFilterBefore(
    new StatelessAuthenticationFilter(new ExpringTokenFactory()),
    UsernamePasswordAuthenticationFilter.class
);
</pre></div></div>
<div class="section">
<h4>Default Behaviour<a name="Default_Behaviour"></a></h4>
<p>When using the simple string only constructors the handler and filter will do default token and authentication generation. The default generation is very simple, but could be enough in some situations.</p>
<div class="section">
<h5>Default Token<a name="Default_Token"></a></h5>
<p>The default generated <tt>X-AUTH-TOKEN</tt> is a <a class="externalLink" href="http://jwt.io/">JWT</a> token that is generated from the Spring Security authentication name with no expiry date. That is it will be valid for ever and can only be invalidated by changing the global application secret. This isn&#x2019;t very secure, so in most situations you will want to override it by creating your own <tt>TokenFactory</tt> implementation as mentioned above. The <a class="externalLink" href="https://github.com/shiver-me-timbers/smt-spring-security-stateless/blob/master/src/main/java/shiver/me/timbers/security/token/BasicJwtTokenFactory.java"><tt>BasicJwtTokenFactory</tt></a> is a good example to help you get started on a more secure JWT <tt>TokenFactory</tt>. Though you are of course free to use any token generation strategy of your choosing.</p></div>
<div class="section">
<h5>Default Authentication<a name="Default_Authentication"></a></h5>
<p>An <a class="externalLink" href="https://github.com/shiver-me-timbers/smt-spring-security-stateless/blob/master/src/main/java/shiver/me/timbers/security/spring/AuthenticatedAuthentication.java"><tt>AuthenticatedAuthentication</tt></a> is generated by default. This should actually be enough in most simple situations. If you are not going to need to lock/disable accounts or use roles then you will not need to customise this behaviour.</p>
<p>Though, if you do need to customise it, say to add the ability to lock accounts then you can provide your own <a class="externalLink" href="https://github.com/shiver-me-timbers/smt-spring-security-stateless/blob/master/src/main/java/shiver/me/timbers/security/spring/AuthenticationFactory.java"><tt>AuthenticationFactory</tt></a>.</p>

<div class="source">
<pre>http.addFilterBefore(
    new StatelessAuthenticationFilter(tokenFactory, new LockableAuthenticationFactory()),
    UsernamePasswordAuthenticationFilter.class
);
</pre></div></div></div></div>
<div class="section">
<h3>Examples<a name="Examples"></a></h3>
<p>A couple examples have been provide to show how to use this library.</p>
<div class="section">
<h4><a class="externalLink" href="https://github.com/shiver-me-timbers/smt-spring-security-stateless-examples/tree/master/smt-spring-security-stateless-basic">smt-spring-security-stateless-basic</a><a name="smt-spring-security-stateless-basic"></a></h4>
<p>This example shows how to use the library with it&#x2019;s default configuration.</p></div>
<div class="section">
<h4><a class="externalLink" href="https://github.com/shiver-me-timbers/smt-spring-security-stateless-examples/tree/master/smt-spring-security-stateless-advanced">smt-spring-security-stateless-advanced</a><a name="smt-spring-security-stateless-advanced"></a></h4>
<p>This example shows how you can customise the library to generate your own tokens and authentications.</p></div></div></div>
      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">
              Copyright &#169;                   2015.
          All Rights Reserved.      
                    
                  </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
